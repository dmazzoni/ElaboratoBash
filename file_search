#!/bin/bash

if [ -z "$2" ]; then
  	echo "Usage: file_search <repo> <pattern>"
	exit
fi

repo=$1

if [ ! -d "$1" ]; then
	echo "Directory \"$repo\" does not exist."
	exit
fi

find_output=`find $repo -type f`
while read file_name; do
	if [ -n "`grep -i "$2" "$file_name"`" ]; then
		file_list+="./`echo $file_name | cut -d/ -f2-`\n"
	fi
done <<< "$find_output"

if [ -z "$file_list" ]; then
	echo "Pattern not found."
else
	echo -e "$file_list" | sort
	echo ""
fi
